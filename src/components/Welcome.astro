
  <main class="min-h-screen bg-gradient-to-b from-black via-black to-[#0a0a0a] text-white">
    <section class="py-16 md:py-24 bg-black/50 backdrop-blur-sm">
      <div class="container mx-auto px-4">
        <h2 class="text-2xl font-bold mb-8 text-center">Research Publications</h2>

        <div id="error-box" class="hidden bg-red-900/50 border border-red-800 rounded-lg p-4 mb-6 text-red-300"></div>

        <div id="table-container" class="overflow-x-auto bg-neutral-900 rounded-xl p-4 border border-neutral-800">
          <div id="loading" class="text-center text-neutral-400 italic">Loading publications...</div>

          <table id="pub-table" class="w-full border-collapse hidden">
            <thead>
              <tr class="border-b border-neutral-700">
                <th class="p-3 text-left text-neutral-300">Title of Publication</th>
                <th class="p-3 text-left text-neutral-300">Name of Author</th>
                <th class="p-3 text-left text-neutral-300">Date of Publication</th>
                <th class="p-3 text-left text-neutral-300">Journal</th>
                <th class="p-3 text-left text-neutral-300">EC Faculty</th>
                <th class="p-3 text-left text-neutral-300">CoEs</th>
              </tr>
            </thead>
            <tbody id="pub-body"></tbody>
          </table>
        </div>
      </div>
    </section>
  </main>


<script type="module">
  const table = document.getElementById('pub-table');
  const tbody = document.getElementById('pub-body');
  const loading = document.getElementById('loading');
  const errorBox = document.getElementById('error-box');

  async function loadPublications() {
    try {
      const res = await fetch("https://script.google.com/macros/s/AKfycbxQHBTHUUgEM_SKrE7T-dBUMPXxtlyGiLznNNGyaJVMOdugL1nf23NzvMm1_xTj99Qxzg/exec?ts=" + Date.now());
      if (!res.ok) throw new Error(`${res.status} ${res.statusText}`);
      const json = await res.json();
      const data = json.data || [];

      if (data.length === 0) {
        loading.textContent = "No publications found.";
        return;
      }

      data.forEach(item => {
        const row = document.createElement('tr');
        row.className = "border-b border-neutral-700 hover:bg-neutral-800";

        const date = new Date(item.Date);
        const formattedDate = `${String(date.getDate()).padStart(2, '0')}-${String(date.getMonth() + 1).padStart(2, '0')}-${date.getFullYear()}`;

        row.innerHTML = `
          <td class="p-3 text-neutral-300">${item.Title}</td>
          <td class="p-3 text-neutral-300">${item.Author}</td>
          <td class="p-3 text-neutral-300">${formattedDate}</td>
          <td class="p-3 text-neutral-300">${item.Journal}</td>
          <td class="p-3 text-neutral-300">${item.ECFaculty}</td>
          <td class="p-3 text-neutral-300">${item.CoEs}</td>
        `;
        tbody.appendChild(row);
      });

      loading.classList.add("hidden");
      table.classList.remove("hidden");
    } catch (err) {
      loading.classList.add("hidden");
      errorBox.classList.remove("hidden");
      errorBox.textContent = "Error loading data: " + err.message;
    }
  }

  loadPublications();
</script>
